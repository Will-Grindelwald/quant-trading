# QuantCapital Javaäº¤æ˜“å¼•æ“ - ç”¨æˆ·æ‰‹å†Œ

## ğŸ“‹ æ¦‚è¿°

QuantCapital Javaäº¤æ˜“å¼•æ“æ˜¯é«˜æ€§èƒ½çš„é‡åŒ–äº¤æ˜“ç³»ç»Ÿæ ¸å¿ƒç»„ä»¶ï¼Œé‡‡ç”¨æ··åˆæ¶æ„è®¾è®¡ï¼š
- **Python**ï¼šè´Ÿè´£æ•°æ®è·å–ä¸å­˜å‚¨ï¼ˆAKShareã€æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ã€Parquetæ–‡ä»¶ã€DuckDBã€SQLiteï¼‰
- **Java**ï¼šè´Ÿè´£äº‹ä»¶é©±åŠ¨å¼•æ“åŠæ•´ä¸ªå›æµ‹/å®ç›˜äº¤æ˜“æµç¨‹

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- âš¡ **é«˜æ€§èƒ½**ï¼šåŸºäºJava 21è™šæ‹Ÿçº¿ç¨‹ï¼ŒZGCåƒåœ¾æ”¶é›†å™¨ï¼Œæ”¯æŒä¸‡çº§TPSäº‹ä»¶å¤„ç†
- ğŸ”„ **äº‹ä»¶é©±åŠ¨**ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†æ¶æ„ï¼Œæ•…éšœéš”ç¦»ï¼Œä½å»¶è¿Ÿå“åº”
- ğŸ“Š **æ•°æ®å…¼å®¹**ï¼šå®Œç¾è¯»å–Pythonç”Ÿæˆçš„Parquetã€DuckDBã€SQLiteæ•°æ®
- ğŸ§  **æ™ºèƒ½ç­–ç•¥**ï¼šæ”¯æŒå¼€å•ç­–ç•¥ã€æ­¢ç›ˆæ­¢æŸç­–ç•¥ã€é€šç”¨å¼ºåˆ¶æ­¢æŸç­–ç•¥
- ğŸ›¡ï¸ **é£æ§å®Œå–„**ï¼šå¤šå±‚æ¬¡é£æ§æ£€æŸ¥ï¼Œå®æ—¶ä»“ä½ç®¡ç†ï¼Œé£é™©ç›‘æ§
- ğŸ”§ **é…ç½®çµæ´»**ï¼šæ”¯æŒå›æµ‹/å®ç›˜ç¯å¢ƒåˆ‡æ¢ï¼Œå‚æ•°çƒ­æ›´æ–°

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- **Java 21+** ï¼ˆå¿…é¡»æ”¯æŒè™šæ‹Ÿçº¿ç¨‹ï¼‰
- **Maven 3.8+**
- **å†…å­˜**: å»ºè®®8GBä»¥ä¸Š
- **å­˜å‚¨**: 10GBä»¥ä¸Šï¼ˆç”¨äºæ•°æ®å­˜å‚¨ï¼‰

### 2. å®‰è£…å’Œå¯åŠ¨

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd quant-trading-java

# 2. ç¼–è¯‘é¡¹ç›®
mvn clean compile

# 3. è¿è¡Œæµ‹è¯•ï¼ˆéªŒè¯ç¯å¢ƒï¼‰
mvn test

# 4. å¯åŠ¨å›æµ‹æ¨¡å¼
mvn spring-boot:run -Dspring.profiles.active=backtest

# 5. å¯åŠ¨å®ç›˜æ¨¡å¼
mvn spring-boot:run -Dspring.profiles.active=live
```

### 3. é…ç½®è¯´æ˜

ä¸»è¦é…ç½®æ–‡ä»¶ï¼š`src/main/resources/application.yml`

```yaml
quantcapital:
  mode: backtest  # è¿è¡Œæ¨¡å¼: backtest, live
  
  # æ•°æ®é…ç½® - è¯»å–Pythonç”Ÿæˆçš„æ•°æ®
  data:
    root-path: "./data"  # Pythonæ•°æ®å­˜å‚¨æ ¹ç›®å½•
    parquet-path: "./data/kline"  # Kçº¿æ•°æ®è·¯å¾„
    sqlite-path: "./data/business.db"  # ä¸šåŠ¡æ•°æ®åº“
  
  # è´¦æˆ·é…ç½®
  account:
    initial-capital: 1000000.0  # åˆå§‹èµ„é‡‘ï¼ˆå…ƒï¼‰
  
  # ç»„åˆé£æ§é…ç½®
  portfolio:
    max-position-percent: 5.0     # å•æ ‡çš„æœ€å¤§ä»“ä½(%)
    max-total-position-percent: 95.0  # æ€»ä»“ä½ä¸Šé™(%)
    min-order-amount: 1000.0      # æœ€å°ä¸‹å•é‡‘é¢(å…ƒ)
```

## ğŸ“Š æ•°æ®æ¥å…¥

### Pythonæ•°æ®å‡†å¤‡

ç¡®ä¿Pythonç«¯å·²ç”Ÿæˆä»¥ä¸‹æ•°æ®ï¼š

```bash
data/
â”œâ”€â”€ kline/                    # Kçº¿æ•°æ®ï¼ˆParquetæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ frequency=daily/
â”‚   â”œâ”€â”€ frequency=hourly/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ business.db              # SQLiteä¸šåŠ¡æ•°æ®åº“
â””â”€â”€ indicators/              # æŠ€æœ¯æŒ‡æ ‡æ•°æ®
```

### æ•°æ®éªŒè¯

å¯åŠ¨åè®¿é—®ï¼š`http://localhost:8080/api/actuator/health`

```json
{
  "status": "UP",
  "components": {
    "dataHealth": {
      "status": "UP",
      "details": {
        "symbols": 1000,
        "dateRange": "2023-01-01 to 2023-12-31",
        "lastUpdate": "2023-12-31T15:00:00"
      }
    }
  }
}
```

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

### 1. äº‹ä»¶é©±åŠ¨å¼•æ“

ç³»ç»ŸåŸºäºäº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œæ”¯æŒä»¥ä¸‹äº‹ä»¶ç±»å‹ï¼š

- **MarketEvent**: å¸‚åœºæ•°æ®æ›´æ–°äº‹ä»¶
- **SignalEvent**: ç­–ç•¥ä¿¡å·äº‹ä»¶
- **OrderEvent**: è®¢å•äº‹ä»¶
- **FillEvent**: æˆäº¤äº‹ä»¶
- **TimerEvent**: å®šæ—¶å™¨äº‹ä»¶

### 2. ç­–ç•¥æ¡†æ¶

æ”¯æŒä¸‰ç§ç­–ç•¥ç±»å‹ï¼š

#### å¼€å•ç­–ç•¥ï¼ˆEntry Strategyï¼‰
```java
@Component
public class MyEntryStrategy implements BaseStrategy {
    @Override
    public List<Signal> onMarketEvent(MarketEvent event) {
        // åˆ†æå¸‚åœºæ•°æ®ï¼Œäº§ç”Ÿä¹°å…¥ä¿¡å·
        Bar bar = event.getBar();
        if (ä¹°å…¥æ¡ä»¶æ»¡è¶³) {
            Signal signal = new Signal(
                getStrategyId(), 
                bar.getSymbol(),
                SignalDirection.BUY,
                0.8,  // ä¿¡å·å¼ºåº¦
                LocalDateTime.now(),
                bar.getClose(),
                "æŠ€æœ¯æŒ‡æ ‡é‡‘å‰"
            );
            return List.of(signal);
        }
        return List.of();
    }
}
```

#### æ­¢ç›ˆæ­¢æŸç­–ç•¥ï¼ˆExit Strategyï¼‰
```java
@Component
public class MyExitStrategy implements BaseStrategy {
    @Override
    public List<Signal> onMarketEvent(MarketEvent event) {
        // æ£€æŸ¥å·²æœ‰æŒä»“ï¼Œäº§ç”Ÿå–å‡ºä¿¡å·
        // å®ç°æ­¢ç›ˆã€æ­¢æŸé€»è¾‘
        return signals;
    }
}
```

### 3. é£æ§ç³»ç»Ÿ

è‡ªåŠ¨é£æ§æ£€æŸ¥åŒ…æ‹¬ï¼š

- **ä»“ä½æ§åˆ¶**: å•æ ‡çš„ä»“ä½â‰¤5%ï¼Œæ€»ä»“ä½â‰¤95%
- **èµ„é‡‘ç®¡ç†**: å¯ç”¨èµ„é‡‘æ£€æŸ¥ï¼Œå†»ç»“èµ„é‡‘ç®¡ç†
- **é£é™©ç›‘æ§**: æ—¥å†…äºæŸâ‰¤2%ï¼Œæœ€å¤§å›æ’¤â‰¤10%
- **åˆè§„æ£€æŸ¥**: STè‚¡ç¥¨é™åˆ¶ï¼Œæ–°è‚¡æ£€æŸ¥

### 4. æ‰§è¡Œç³»ç»Ÿ

æ”¯æŒä¸¤ç§æ‰§è¡Œæ¨¡å¼ï¼š

#### å›æµ‹æ‰§è¡Œ
- æ¨¡æ‹Ÿå¸‚åœºæˆäº¤
- æ»‘ç‚¹å’Œæ‰‹ç»­è´¹æ¨¡æ‹Ÿ
- å»¶è¿Ÿæ¨¡æ‹Ÿ

#### å®ç›˜æ‰§è¡Œï¼ˆé¢„ç•™MiniQMTæ¥å£ï¼‰
- çœŸå®è®¢å•æ‰§è¡Œ
- å®æ—¶é£æ§æ£€æŸ¥
- å¼‚å¸¸å¤„ç†å’Œé‡è¯•

## ğŸ“ˆ ä½¿ç”¨ç¤ºä¾‹

### ç®€å•çš„å‡çº¿äº¤å‰ç­–ç•¥

```java
@Component
public class MACrossStrategy implements BaseStrategy {
    
    private final String strategyId = "ma_cross_strategy";
    
    @Override
    public List<Signal> onMarketEvent(MarketEvent event) {
        Bar bar = event.getBar();
        
        // æ£€æŸ¥æŠ€æœ¯æŒ‡æ ‡æ˜¯å¦å¯ç”¨
        if (bar.getMa5() == null || bar.getMa20() == null) {
            return List.of();
        }
        
        List<Signal> signals = new ArrayList<>();
        
        // é‡‘å‰ä¹°å…¥ä¿¡å·
        if (bar.getMa5() > bar.getMa20() && 
            isGoldenCross(bar.getSymbol())) {
            
            Signal buySignal = new Signal(
                strategyId,
                bar.getSymbol(),
                SignalDirection.BUY,
                0.7,
                LocalDateTime.now(),
                bar.getClose(),
                "MA5ä¸Šç©¿MA20é‡‘å‰ä¹°å…¥"
            );
            signals.add(buySignal);
        }
        
        return signals;
    }
    
    private boolean isGoldenCross(String symbol) {
        // æ£€æŸ¥å‰ä¸€æœŸæ˜¯å¦MA5 < MA20ï¼ˆç¡®è®¤æ˜¯é‡‘å‰ï¼‰
        // å®ç°é€»è¾‘...
        return true;
    }
    
    @Override
    public String getStrategyId() { return strategyId; }
    @Override
    public String getName() { return "å‡çº¿äº¤å‰ç­–ç•¥"; }
    @Override
    public StrategyType getStrategyType() { return StrategyType.ENTRY; }
    // ... å…¶ä»–å¿…é¡»å®ç°çš„æ–¹æ³•
}
```

### è¿è¡Œå›æµ‹

```java
@RestController
public class BacktestController {
    
    @Autowired
    private EventEngine eventEngine;
    
    @PostMapping("/api/backtest/start")
    public ResponseEntity<String> startBacktest(@RequestBody BacktestRequest request) {
        // é…ç½®å›æµ‹å‚æ•°
        BacktestConfig config = BacktestConfig.builder()
            .startDate(request.getStartDate())
            .endDate(request.getEndDate())
            .universe(request.getSymbols())
            .initialCapital(request.getCapital())
            .build();
        
        // å¯åŠ¨å›æµ‹
        BacktestEngine backtestEngine = new BacktestEngine(config);
        backtestEngine.start();
        
        return ResponseEntity.ok("å›æµ‹å·²å¯åŠ¨");
    }
}
```

## ğŸ” ç›‘æ§å’Œè°ƒè¯•

### 1. ç³»ç»Ÿç›‘æ§

è®¿é—®ç›‘æ§ç«¯ç‚¹ï¼š
- å¥åº·æ£€æŸ¥: `GET /api/actuator/health`
- æ€§èƒ½æŒ‡æ ‡: `GET /api/actuator/metrics`
- äº‹ä»¶å¼•æ“ç»Ÿè®¡: `GET /api/engine/stats`

```json
{
  "running": true,
  "queueSize": 10,
  "totalEvents": 50000,
  "processedEvents": 49995,
  "failedEvents": 3,
  "droppedEvents": 2,
  "eventsPerSecond": 1250.5
}
```

### 2. æ—¥å¿—é…ç½®

æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š`logs/quant-trading.log`

å…³é”®æ—¥å¿—æ¨¡å—ï¼š
- `com.quantcapital.engine`: äº‹ä»¶å¼•æ“æ—¥å¿—
- `com.quantcapital.strategy`: ç­–ç•¥æ‰§è¡Œæ—¥å¿—
- `com.quantcapital.portfolio`: é£æ§æ—¥å¿—
- `com.quantcapital.execution`: è®¢å•æ‰§è¡Œæ—¥å¿—

### 3. æ€§èƒ½è°ƒä¼˜

JVMå¯åŠ¨å‚æ•°å»ºè®®ï¼š
```bash
java -XX:+UseZGC \
     -XX:+UnlockExperimentalVMOptions \
     -Xmx8g \
     -XX:+FlightRecorder \
     --enable-preview \
     -jar trading-engine.jar
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### æ•°æ®ä¸€è‡´æ€§
- ç¡®ä¿Pythonæ•°æ®æ›´æ–°åŠæ—¶
- å®šæœŸæ£€æŸ¥æ•°æ®å®Œæ•´æ€§
- ç›‘æ§æ•°æ®å»¶è¿Ÿ

### é£é™©æ§åˆ¶
- ä¸¥æ ¼éµå®ˆä»“ä½é™åˆ¶
- å®šæœŸæ£€æŸ¥æ­¢æŸè®¾ç½®
- ç›‘æ§ç³»ç»Ÿå¼‚å¸¸

### æ€§èƒ½ç›‘æ§
- å…³æ³¨äº‹ä»¶å¤„ç†å»¶è¿Ÿ
- ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ
- åŠæ—¶å¤„ç†é˜Ÿåˆ—å †ç§¯

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å¯åŠ¨å¤±è´¥**
   ```
   æ£€æŸ¥Javaç‰ˆæœ¬æ˜¯å¦21+
   æ£€æŸ¥æ•°æ®ç›®å½•æ˜¯å¦å­˜åœ¨
   ç¡®è®¤é…ç½®æ–‡ä»¶æ­£ç¡®
   ```

2. **æ•°æ®åŠ è½½å¼‚å¸¸**
   ```
   éªŒè¯Pythonæ•°æ®æ˜¯å¦å­˜åœ¨
   æ£€æŸ¥æ–‡ä»¶æƒé™
   ç¡®è®¤æ•°æ®æ ¼å¼æ­£ç¡®
   ```

3. **äº‹ä»¶å¤„ç†å»¶è¿Ÿ**
   ```
   æ£€æŸ¥é˜Ÿåˆ—å¤§å°
   å¢åŠ å·¥ä½œçº¿ç¨‹æ•°
   ä¼˜åŒ–ç­–ç•¥é€»è¾‘
   ```

4. **å†…å­˜ä¸è¶³**
   ```
   å¢åŠ JVMå †å†…å­˜
   å¯ç”¨ZGCåƒåœ¾æ”¶é›†å™¨
   å‡å°‘æ•°æ®é¢„åŠ è½½é‡
   ```

### æŠ€æœ¯æ”¯æŒ

- æŸ¥çœ‹é¡¹ç›®Wikiæ–‡æ¡£
- æäº¤GitHub Issue
- è”ç³»å¼€å‘å›¢é˜Ÿ

---

> **å…è´£å£°æ˜**: æœ¬ç³»ç»Ÿä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ï¼Œå®ç›˜äº¤æ˜“æœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…ã€‚ä½¿ç”¨è€…åº”å……åˆ†è¯„ä¼°é£é™©ï¼Œåæœè‡ªè´Ÿã€‚